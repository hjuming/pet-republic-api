<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Pet Republic｜後台</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">
<header class="sticky top-0 z-10 bg-white/90 backdrop-blur border-b">
  <div class="max-w-5xl mx-auto px-4 py-4 flex items-center gap-3">
    <h1 class="text-2xl font-extrabold">Pet Republic｜後台</h1>
    <div class="flex-1"></div>
    <a href="/" class="rounded-lg border px-4 py-2">回前台清單頁</a>
  </div>
</header>
<main class="max-w-5xl mx-auto px-4 py-6">
  <section class="bg-white rounded-2xl shadow border p-6">
    <h2 class="text-xl font-bold mb-2">Airtable 同步</h2>
    <p class="text-gray-600 mb-4">按下即可觸發一次匯入（僅管理員可用）。</p>
    <div class="flex items-center gap-3 mb-4">
      <input id="u" class="border rounded-lg px-3 py-2" placeholder="USERNAME（只存於本機）">
      <input id="p" type="password" class="border rounded-lg px-3 py-2" placeholder="PASSWORD（只存於本機）">
      <button id="go" class="rounded-lg bg-indigo-600 text-white px-4 py-2">開始同步</button>
    </div>
    <pre id="out" class="bg-gray-900 text-white p-4 rounded-lg overflow-auto"></pre>
  </section>
</main>
<script>
const $ = (id)=>document.getElementById(id);
const LS = { u:()=>localStorage.getItem("admin_u")||"", p:()=>localStorage.getItem("admin_p")||"", set(u,p){localStorage.setItem("admin_u",u);localStorage.setItem("admin_p",p);} };
$("u").value = LS.u(); $("p").value = LS.p();
$("go").onclick = async ()=>{
  const u = $("u").value.trim(), p = $("p").value;
  LS.set(u,p);
  const res = await fetch("/sync-airtable",{ method:"POST", headers:{ "Authorization":"Basic "+btoa(u+":"+p) }});
  const data = await res.json().catch(()=>({ok:false,error:"非 JSON"}));
  $("out").textContent = JSON.stringify(data,null,2);
};
</script>
</body>
</html>
